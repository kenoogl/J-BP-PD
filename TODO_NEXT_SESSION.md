# æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿæ–½ã™ã‚‹ä½œæ¥­

## ğŸ“ ç¾åœ¨ã®çŠ¶æ…‹

### âœ… å®Œäº†ã—ãŸãƒ•ã‚§ãƒ¼ã‚º

#### ãƒ•ã‚§ãƒ¼ã‚º1: Jensenä¸­å¿ƒç·šãƒ•ã‚£ãƒƒãƒˆä¿®æ­£ï¼ˆå®Œäº†ï¼‰
- 2ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚£ãƒƒãƒˆ `[kw, Ct_eff]` ã¸ã®å¤‰æ›´
- æ®‹å·®99.6%æ”¹å–„ï¼ˆ0.732 â†’ 0.003ï¼‰
- å…¨31ã‚±ãƒ¼ã‚¹ãŒé–¾å€¤ä»¥å†…ã«åã¾ã‚‹

#### ãƒ•ã‚§ãƒ¼ã‚º2: ä¿‚æ•°å›å¸°ãƒ¢ãƒ‡ãƒ«æ›´æ–°ï¼ˆå®Œäº†ï¼‰+ x_shiftç²¾åº¦æ”¹å–„
- `coefficients_two_region(I, Ct)` é–¢æ•°ã‚’å®Ÿè£…
- 6ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å›å¸°åˆ†æå®Œäº†
- **å…¨6ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§RÂ²>0.85é”æˆ**

**æœ€çµ‚å›å¸°ç²¾åº¦ã‚µãƒãƒªãƒ¼**:
```
Parameter   | RÂ²     | RMSE   | è©•ä¾¡
------------|--------|--------|------
Ct_eff      | 0.945  | 0.021  | âœ“
sigmaJ0     | 0.942  | 0.002  | âœ“
sigmaG0     | 0.976  | 0.006  | âœ“
km          | 0.972  | 0.001  | âœ“
kw          | 0.858  | 0.006  | â—‹
x_shift     | 0.985  | 0.345  | âœ“  â† æ”¹å–„ï¼(æ—§: RÂ²=0.467)
```

**x_shiftæ”¹å–„ã®è©³ç´°**:
- åŸºæœ¬åŸºåº• `[1, I, C, IÂ·C]` â†’ æ‹¡å¼µåŸºåº• `[1, I, C, IÂ·C, 1/I, C/I]`
- RÂ² 0.467 â†’ **0.985** (+111%)
- RMSE 2.024 â†’ **0.345** (-83%)
- éç·šå½¢åŸºåº•ã¨åŒºåˆ†ãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒæ¤œè¨¼ã—ã€éç·šå½¢åŸºåº•ã‚’æ¡ç”¨

#### ãƒ•ã‚§ãƒ¼ã‚º3: äºŒé ˜åŸŸé€Ÿåº¦å ´å†æ§‹æˆï¼ˆå®Œäº†ï¼‰+ å¯è¦–åŒ–æ‹¡å¼µ
- `plot_reconstructed_wake.jl` ã«äºŒé ˜åŸŸãƒ¢ãƒ‡ãƒ«å®Ÿè£…
- Jensen/Bastankhahé ˜åŸŸã®é€Ÿåº¦å ´è¨ˆç®—
- CLIã‚ªãƒ—ã‚·ãƒ§ãƒ³è¿½åŠ : `--two-region` (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ), `--single-gauss`
- å¯è¦–åŒ–æ©Ÿèƒ½å®Œå…¨å®Ÿè£…:
  - x_shiftä½ç½®è¡¨ç¤ºï¼ˆã‚·ã‚¢ãƒ³è‰²ç ´ç·šï¼‰
  - é ˜åŸŸè‰²åˆ†ã‘ï¼ˆJensen: èµ¤ã€Bastankhah: é’ï¼‰
  - Ïƒ(x)æ¨ç§»ãƒ—ãƒ­ãƒƒãƒˆï¼ˆæ–°è¦ï¼‰
  - ä¸­å¿ƒç·šé€Ÿåº¦æ¬ æãƒ—ãƒ­ãƒƒãƒˆï¼ˆæ–°è¦ï¼‰

**å®Ÿè£…æ¸ˆã¿é–¢æ•°**:
- `compute_jensen_deficit(x, kw, Ct_eff)` - Jensené€Ÿåº¦æ¬ æ
- `compute_bastankhah_deficit(sigma, Ct_eff)` - Bastankhahé€Ÿåº¦æ¬ æ
- `compute_jensen_sigma(x, sigmaJ0, kw)` - Jensen Ïƒ(x)
- `compute_bastankhah_sigma(x, x_shift, sigmaG0, km)` - Bastankhah Ïƒ(x)
- `compute_two_region_wake(x, r, params, Uâˆ)` - äºŒé ˜åŸŸé€Ÿåº¦å ´
- `create_two_region_analysis_plots(...)` - è©³ç´°è§£æãƒ—ãƒ­ãƒƒãƒˆ

**ç”Ÿæˆã•ã‚Œã‚‹å›³ï¼ˆè¨ˆ5æš/ã‚±ãƒ¼ã‚¹ï¼‰**:
1. `wake_two_region_*.png` - x_shiftç·šä»˜ãé€Ÿåº¦å ´
2. `deficit_two_region_*.png` - é€Ÿåº¦æ¬ æå ´
3. `profile_two_region_*.png` - å¾„æ–¹å‘ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
4. `sigma_evolution_*.png` - Ïƒ(x)æ¨ç§»ï¼ˆé ˜åŸŸè‰²åˆ†ã‘ï¼‰
5. `deficit_centerline_*.png` - ä¸­å¿ƒç·šé€Ÿåº¦æ¬ æ vs CFD

### ğŸ“‚ ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«

**ãƒ‡ãƒ¼ã‚¿**:
- `fit_coefficients_summary.csv` - 31ã‚±ãƒ¼ã‚¹ã€23ã‚«ãƒ©ãƒ 
  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: kw, Ct_eff, sigmaJ0, sigmaG0, km, x_shift

**ãƒ¢ãƒ‡ãƒ«**:
- `src/coeff_model.jl` - ä¿‚æ•°å›å¸°ãƒ¢ãƒ‡ãƒ«
  - `coefficients_two_region(I, Ct)` - æ–°ãƒ¢ãƒ‡ãƒ«ï¼ˆå…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿RÂ²>0.85ï¼‰
  - `coefficients_from_IC(I, Ct)` - æ—§ãƒ¢ãƒ‡ãƒ«ï¼ˆå¾Œæ–¹äº’æ›ï¼‰

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**:
- `src/fit_gaussian_wake.jl` - CFDãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æŠ½å‡º
- `src/compute_regression_coeffs.jl` - å›å¸°ä¿‚æ•°è¨ˆç®—
- `src/test_coeff_model.jl` - ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
- `src/compare_xshift_models.jl` - x_shiftæ”¹å–„æ¡ˆæ¯”è¼ƒæ¤œè¨¼ï¼ˆæ–°è¦ï¼‰
- `src/plot_reconstructed_wake.jl` - é€Ÿåº¦å ´å†æ§‹æˆã¨å¯è¦–åŒ–ï¼ˆæ‹¡å¼µå®Œäº†ï¼‰

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
- `JensenBastankhah_Plan.md` - é–‹ç™ºè¨ˆç”»ã¨ä½œæ¥­ãƒ­ã‚°
- `CHANGELOG.md` - å¤‰æ›´å±¥æ­´
- `FigGaussPD.md` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®èª¬æ˜

### ğŸ¯ æœ€è¿‘ã®ã‚³ãƒŸãƒƒãƒˆï¼ˆæœ¬ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰

```
f736c09 Add visualization enhancements for two-region model
f49814d Phase 3: Two-region wake reconstruction implementation
f540e73 Improve x_shift regression: extended basis (RÂ²=0.985)
```

## ğŸ¯ æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿæ–½ã™ã‚‹ã“ã¨ï¼ˆãƒ•ã‚§ãƒ¼ã‚º4ï¼‰

### 1. å…¨ã‚±ãƒ¼ã‚¹æ¤œè¨¼ï¼ˆ31ã‚±ãƒ¼ã‚¹ï¼‰

#### äºŒé ˜åŸŸãƒ¢ãƒ‡ãƒ«ã§å…¨ã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
```bash
julia --project=. src/plot_reconstructed_wake.jl --all --two-region
```

**è¨ˆç®—ã™ã¹ãæŒ‡æ¨™**:
- è¿‘æ¥åŸŸï¼ˆx/D < 2ï¼‰: L2èª¤å·®ã€æœ€å¤§èª¤å·®ã€å¹³å‡ç›¸å¯¾èª¤å·®
- é·ç§»åŸŸï¼ˆ2 â‰¤ x/D â‰¤ 5ï¼‰: åŒä¸Š
- é æ–¹åŸŸï¼ˆx/D > 5ï¼‰: åŒä¸Š

#### å®Ÿè£…ã™ã¹ãæ©Ÿèƒ½
æ–°ã—ã„ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `src/validate_all_cases.jl` ã‚’ä½œæˆ:
```julia
# å„ã‚±ãƒ¼ã‚¹ã§ä»¥ä¸‹ã‚’è¨ˆç®—
for each case:
  1. CFDãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ä¸­å¿ƒç·šé€Ÿåº¦ã‚’æŠ½å‡º
  2. äºŒé ˜åŸŸãƒ¢ãƒ‡ãƒ«ã§äºˆæ¸¬
  3. é ˜åŸŸåˆ¥ã®èª¤å·®ã‚’è¨ˆç®—ï¼ˆL2, max, mean relativeï¼‰
  4. çµæœã‚’ figures/recon_metrics.csv ã«ä¿å­˜
```

**å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ** (`figures/recon_metrics.csv`):
```csv
case,I,Ct,x_shift,l2_near,l2_trans,l2_far,max_near,max_trans,max_far,mean_rel_near,mean_rel_trans,mean_rel_far
I0p0100_C10p0000,0.01,10.0,10.53,...
```

### 2. æ–°æ—§ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ

#### å˜ä¸€ã‚¬ã‚¦ã‚¹ãƒ¢ãƒ‡ãƒ«ã§å…¨ã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
```bash
julia --project=. src/plot_reconstructed_wake.jl --all --single-gauss
```

#### æ¯”è¼ƒã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ `src/compare_models.jl`
- äºŒé ˜åŸŸãƒ¢ãƒ‡ãƒ« vs å˜ä¸€ã‚¬ã‚¦ã‚¹ãƒ¢ãƒ‡ãƒ«ã®èª¤å·®æ¯”è¼ƒ
- æ”¹å–„ç‡ã®è¨ˆç®—
- çµæœã‚’ `figures/model_comparison.csv` ã«ä¿å­˜

### 3. å¤–æŒ¿ãƒ†ã‚¹ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ç¯„å›²å¤–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®ãƒ†ã‚¹ãƒˆ:
```bash
julia --project=. src/plot_reconstructed_wake.jl 0.35 18 --two-region
julia --project=. src/plot_reconstructed_wake.jl 0.005 25 --two-region
julia --project=. src/plot_reconstructed_wake.jl 0.20 8 --two-region
```

çµæœã‚’ `figures/extrapolation/` ã«ä¿å­˜ã—ã€è­¦å‘Šã®æœ‰ç„¡ã‚’ç¢ºèªã€‚

### 4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

ãƒ•ã‚§ãƒ¼ã‚º4å®Œäº†å¾Œ:
1. `JensenBastankhah_Plan.md` ã«ãƒ•ã‚§ãƒ¼ã‚º4ã®çµæœã‚’è¿½è¨˜
2. `CHANGELOG.md` ã‚’æ›´æ–°
3. `FigGaussPD.md` ã®å‡ºåŠ›ç‰©ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°
4. ä»£è¡¨çš„ãª3ã‚±ãƒ¼ã‚¹ã®å›³ã‚’é¸ã³ã€è¨ˆç”»æ›¸ã«æ²è¼‰

## ğŸš€ æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ã‚³ãƒãƒ³ãƒ‰

```bash
cd /Users/Daily/Development/WindTurbineWake/FitGauss-PD

# ç¾çŠ¶ç¢ºèª
git status
git log --oneline -5

# ç’°å¢ƒç¢ºèª
julia --project=. -e 'using Pkg; Pkg.status()'

# æ—¢å­˜æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆï¼ˆå˜ä¸€ã‚±ãƒ¼ã‚¹ï¼‰
julia --project=. src/plot_reconstructed_wake.jl 0.05 16 --two-region

# ãƒ•ã‚§ãƒ¼ã‚º4é–‹å§‹: å…¨ã‚±ãƒ¼ã‚¹æ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
# TODO: src/validate_all_cases.jl ã‚’æ–°è¦ä½œæˆ
```

## ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹æˆæœç‰©ï¼ˆãƒ•ã‚§ãƒ¼ã‚º4ï¼‰

1. **æ¤œè¨¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**
   - `src/validate_all_cases.jl` - å…¨ã‚±ãƒ¼ã‚¹èª¤å·®è©•ä¾¡
   - `src/compare_models.jl` - æ–°æ—§ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ

2. **æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿**
   - `figures/recon_metrics.csv` - ç²¾åº¦è©•ä¾¡ï¼ˆ31ã‚±ãƒ¼ã‚¹ï¼‰
   - `figures/model_comparison.csv` - æ–°æ—§æ¯”è¼ƒ
   - `figures/extrapolation/*.png` - å¤–æŒ¿ãƒ†ã‚¹ãƒˆçµæœ

3. **å¯è¦–åŒ–**
   - å…¨31ã‚±ãƒ¼ã‚¹ã®å›³ï¼ˆ155æš = 5æšÃ—31ã‚±ãƒ¼ã‚¹ï¼‰
   - èª¤å·®åˆ†å¸ƒã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
   - æ”¹å–„ç‡ã®ãƒãƒ¼ãƒ—ãƒ­ãƒƒãƒˆ

4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
   - æ›´æ–°ã•ã‚ŒãŸ `JensenBastankhah_Plan.md`
   - æ›´æ–°ã•ã‚ŒãŸ `CHANGELOG.md`
   - æœ€çµ‚å ±å‘Šæ›¸ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

5. **Gitã‚³ãƒŸãƒƒãƒˆ**
   - "Phase 4: Full case validation and model comparison"

## ğŸ“ é‡è¦ãªæ³¨æ„äº‹é …

### ãƒ‡ãƒ¼ã‚¿ã®å ´æ‰€
- CFDãƒ‡ãƒ¼ã‚¿: `data/result_I*_C*.csv`
- ãƒ•ã‚£ãƒƒãƒˆçµæœ: `fit_coefficients_summary.csv`
- ç”Ÿæˆå›³: `figures/`

### ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç¯„å›²
- I: [0.01, 0.30]
- Ct: [10.0, 22.0]
- ç¯„å›²å¤–ã¯è­¦å‘ŠãŒå‡ºã‚‹ï¼ˆå¤–æŒ¿ã¨ãªã‚‹ï¼‰

### ç‰©ç†çš„åˆ¶ç´„
- kw â‰¥ 0
- Ct_eff âˆˆ [0, 0.99]
- Ïƒ > 0
- x_shift â‰¥ 0.5

### äºŒé ˜åŸŸãƒ¢ãƒ‡ãƒ«ã®æ•°å¼

**Jensené ˜åŸŸ** (x < x_shift):
```
Î”U/Uâˆ = 1 - âˆš{1 - Ct_eff/(1 + 2*kw*x)Â²}
Ïƒ(x) = sigmaJ0 + 2*kw*x
```

**Bastankhahé ˜åŸŸ** (x â‰¥ x_shift):
```
Î”U/Uâˆ = 1 - âˆš{1 - Ct_eff/(8*(Ïƒ/D)Â²)}
Ïƒ(x) = sigmaG0 + km*(x - x_shift)
```

**å¾„æ–¹å‘åˆ†å¸ƒ**:
```
u(x,r) = Uâˆ * [1 - Î”U(x,0) * exp(-rÂ²/(2ÏƒÂ²))]
```

## ğŸ› æ—¢çŸ¥ã®èª²é¡Œã¨æ³¨æ„ç‚¹

1. **x_shiftç²¾åº¦**: RÂ²=0.985ã¨å¤§å¹…æ”¹å–„ã—ãŸãŒã€äºˆæ¸¬å€¤ã«ã¯ã¾ã Â±0.3Dç¨‹åº¦ã®èª¤å·®ãŒã‚ã‚‹
2. **kwç²¾åº¦**: RÂ²=0.858ã¨ã‚„ã‚„ä½ã„ï¼ˆä½IåŸŸã§kwâ‰ˆ0ã¨ãªã‚Šä¸å®‰å®šï¼‰
3. **æ¥ç¶šç‚¹ã®ä¸é€£ç¶š**: ç†è«–ä¸Šã¯é€£ç¶šã ãŒã€æ•°å€¤çš„ã«å°ã•ãªä¸é€£ç¶šãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§
4. **ä½IåŸŸã®æŒ™å‹•**: kwâ‰ˆ0ã®ãŸã‚ã€Jensené ˜åŸŸãŒã»ã¼å¹³å¦ã«ãªã‚‹

## ğŸ“š å‚è€ƒæƒ…å ±

### ä½¿ç”¨ã‚³ãƒãƒ³ãƒ‰ä¾‹
```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆäºŒé ˜åŸŸãƒ¢ãƒ‡ãƒ«ã€å›å¸°ä¿‚æ•°ï¼‰
julia --project=. src/plot_reconstructed_wake.jl 0.05 16

# å˜ä¸€ã‚¬ã‚¦ã‚¹ãƒ¢ãƒ‡ãƒ«
julia --project=. src/plot_reconstructed_wake.jl 0.05 16 --single-gauss

# CSVå®Ÿæ¸¬å€¤ä½¿ç”¨
julia --project=. src/plot_reconstructed_wake.jl 0.05 16 --summary

# å…¨ã‚±ãƒ¼ã‚¹å‡¦ç†
julia --project=. src/plot_reconstructed_wake.jl --all --two-region
```

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
- ä½ä¹±æµãƒ»ä½C: I=0.01, C=10 (x_shiftâ‰ˆ10.5)
- ä¸­ä¹±æµãƒ»ä¸­C: I=0.05, C=16 (x_shiftâ‰ˆ3.6)
- é«˜ä¹±æµãƒ»é«˜C: I=0.30, C=22 (x_shiftâ‰ˆ1.7)

---

**æœ€çµ‚æ›´æ–°**: 2025-01-18 (æœ¬ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚)
**æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³**: ãƒ•ã‚§ãƒ¼ã‚º4 - å…¨ã‚±ãƒ¼ã‚¹æ¤œè¨¼ã¨ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ
**æ¨å¥¨ä½œæ¥­æ™‚é–“**: 2-3æ™‚é–“
